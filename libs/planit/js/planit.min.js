var Planit,bind=function(t,i){return function(){return t.apply(i,arguments)}};Planit=function(){function t(){this.canvasClick=bind(this.canvasClick,this),this.markerClick=bind(this.markerClick,this),this.markerDragEnd=bind(this.markerDragEnd,this),this.resize=bind(this.resize,this),this.getAllMarkers=bind(this.getAllMarkers,this),this.getMarker=bind(this.getMarker,this),this.addMarker=bind(this.addMarker,this),this.initMarkers=bind(this.initMarkers,this),this.initBackgroundImage=bind(this.initBackgroundImage,this)}return t.containerClass="planit-container",t.markerContainerClass="planit-markers-container",t.markerClass="planit-marker",t.markerContentClass="planit-marker-content",t.infoboxContainerClass="planit-infobox-container",t.prototype["new"]=function(i){return this.options=null!=i?i:{},this.options.container=$(this.options.container?"#"+this.options.container:"#planit"),this.options.container.addClass("planit-container"),this.options.container.append('<div class="'+t.infoboxContainerClass+'"></div>\n<div class="'+t.markerContainerClass+'"></div>'),this.container=this.options.container,this.markersContainer=this.container.find("."+t.markerContainerClass).first(),this.options.image&&this.options.image.url&&(this.container.prepend('<div class="image-container">\n  <img src="'+this.options.image.url+'">\n</div>'),this.initBackgroundImage()),this.options.markers&&this.options.markers.length>0&&this.initMarkers(),new t.Plan.Events({container:this.container,planit:this}),$(window).resize(this.resize),this},t.prototype.initBackgroundImage=function(){var i,n;return i=this.container.find("img").first(),n=i.height(),n>0&&i.width()>0?(this.container.css({height:n}),this.zoomable=new t.Plan.Zoomable({container:this.container}),this.options.image.zoom&&this.zoomable["new"](),this.imgLoaded=!0):setTimeout(this.initBackgroundImage,250)},t.prototype.initMarkers=function(){var t,i,n,o,e,s,r,a,h;if(this.options.image&&this.options.image.url){if(this.imgLoaded===!0){for(s=this.options.markers,a=[],t=0,n=s.length;n>t;t++)e=s[t],a.push(this.addMarker(e));return a}return setTimeout(this.initMarkers,250)}for(r=this.options.markers,h=[],i=0,o=r.length;o>i;i++)e=r[i],h.push(this.addMarker(e));return h},t.prototype.addMarker=function(i){return i.container=this.container,new t.Marker.Creator(i)},t.prototype.getMarker=function(i){return new t.Marker(this.container,i)},t.prototype.getAllMarkers=function(){var i;return i=new t.Plan(this.container),i.getAllMarkers()},t.prototype.centerOn=function(t){return this.zoomable.centerOn(t)},t.prototype.zoomTo=function(t){return this.zoomable.zoomTo(t)},t.prototype.resize=function(){var i,n,o,e,s,r,a;for(i=this.container.find(".image-container > img").first(),this.zoomable.resetImage(),i&&this.container.height(i.height()),r=this.markersContainer.find(".planit-marker"),a=[],n=0,o=r.length;o>n;n++)s=r[n],e=new t.Marker(this.container,$(s).attr("data-marker")),a.push(e.set());return a},t.prototype.markerDragEnd=function(t,i){return this.options.markerDragEnd?this.options.markerDragEnd(t,i):void 0},t.prototype.markerClick=function(t,i){return this.options.markerClick?this.options.markerClick(t,i):void 0},t.prototype.canvasClick=function(t,i){return this.options.canvasClick?this.options.canvasClick(t,i):void 0},t.randomString=function(t){var i;return null==t&&(t=16),i=Math.random().toString(36).slice(2),i+=Math.random().toString(36).slice(2),i.substring(0,t-1)},t}(),window.planit=new Planit,Planit.Plan=function(){function t(t){this.container=t,this.getAllMarkers=bind(this.getAllMarkers,this),this.markersContainer=this.container.find("."+Planit.markerContainerClass).first()}return t.prototype.getAllMarkers=function(){var t,i,n,o,e,s;for(e=[],s=this.markersContainer.find(".planit-marker"),t=0,i=s.length;i>t;t++)o=s[t],n=new Planit.Marker(this.container,$(o).attr("data-marker")),o={coords:n.position(),draggable:n.isDraggable(),color:n.color()},n.infoboxHTML()&&(o.infobox=n.infoboxHTML()),e.push(n);return e},t}(),Planit.Plan.Events=function(){function t(t){this.options=t,this.mousemove=bind(this.mousemove,this),this.mouseup=bind(this.mouseup,this),this.getEventPosition=bind(this.getEventPosition,this),this.draggingMarker=bind(this.draggingMarker,this),this.markers=bind(this.markers,this),this.container=this.options.container,this.markersContainer=this.container.find("."+Planit.markerContainerClass),this.container.find(".image-container > img").length>0&&(this.image=this.container.find(".image-container > img").first()),$(document).on("mousemove",this.mousemove),$(document).on("mouseup",this.mouseup)}return t.prototype.markers=function(){return this.markersContainer.find(".planit-marker")},t.prototype.draggingMarker=function(){return this.markersContainer.find(".planit-marker.is-dragging")},t.prototype.getEventPosition=function(t){var i,n,o,e,s,r,a,h,m,g;return o=parseFloat(this.markersContainer.width()),i=parseFloat(this.markersContainer.height()),this.image?(a=t.pageX-this.container.offset().left,g=t.pageY-this.container.offset().top,e=this.image.width(),n=this.image.height(),s=parseInt(this.image.css("left")),h=parseInt(this.image.css("top")),r=(a+Math.abs(s))/e*100,m=(g+Math.abs(h))/n*100):(r=(t.pageX-this.container.offset().left)/o,m=(t.pageY-this.container.offset().top)/i),[r,m]},t.prototype.mouseup=function(t){var i,n;return n=this.markersContainer.find(".is-dragging").first(),this.draggingMarker().length>0&&(i=new Planit.Marker(this.container,n.attr("data-marker")),this.options.planit.markerDragEnd(t,i),i.savePosition(),i.positionInfobox(),this.draggingMarker().removeClass("is-dragging")),$(t.target).hasClass(Planit.markerContainerClass)&&this.options.planit.canvasClick(t,this.getEventPosition(t)),($(t.target).hasClass(Planit.markerClass)||$(t.target).parents("."+Planit.markerClass).length>0)&&(n=$(t.target).hasClass(Planit.markerClass)?$(t.target):$(t.target).parents("."+Planit.markerClass).first(),i=new Planit.Marker(this.container,n.attr("data-marker")),this.options.planit.markerClick(t,i)),!0},t.prototype.mousemove=function(t){var i,n,o,e,s,r,a,h,m,g,c,p,d,f;return g=this.markersContainer.find(".planit-marker.is-dragging"),g.length>0?(i=g.first(),(Math.abs(t.pageX-i.attr("data-drag-start-x"))>0||Math.abs(t.pageY-i.attr("data-drag-start-y"))>0)&&$("#"+i.attr("data-infobox")).removeClass("active"),c=t.pageX-this.container.offset().left,p=t.pageY-this.container.offset().top,f=this.container.width(),d=this.container.height(),e=c-i.outerWidth()/2,r=p-i.outerHeight()/2,s=c+i.outerWidth()/2,n=p+i.outerHeight()/2,a=i.outerWidth(),o=i.outerHeight(),h=0>=e?0:f>s?e:f-a,m=0>=r?0:d>n?r:d-o,i.css({left:h,top:m})):void 0},t}(),Planit.Plan.Zoomable=function(){function t(t){this.options=t,this.zoomOut=bind(this.zoomOut,this),this.zoomIn=bind(this.zoomIn,this),this.mouseup=bind(this.mouseup,this),this.mousemove=bind(this.mousemove,this),this.mousedown=bind(this.mousedown,this),this.dblclick=bind(this.dblclick,this),this.getEventContainerPosition=bind(this.getEventContainerPosition,this),this.imgOffsetTop=bind(this.imgOffsetTop,this),this.containerHeight=bind(this.containerHeight,this),this.imgHeightScrollIncrement=bind(this.imgHeightScrollIncrement,this),this.imgHeightClickIncrement=bind(this.imgHeightClickIncrement,this),this.tmpImgHeight=bind(this.tmpImgHeight,this),this.imgHeight=bind(this.imgHeight,this),this.imgOffsetLeft=bind(this.imgOffsetLeft,this),this.containerWidth=bind(this.containerWidth,this),this.imgWidthScrollIncrement=bind(this.imgWidthScrollIncrement,this),this.imgWidthClickIncrement=bind(this.imgWidthClickIncrement,this),this.tmpImgWidth=bind(this.tmpImgWidth,this),this.imgWidth=bind(this.imgWidth,this),this.zoomTo=bind(this.zoomTo,this),this.centerOn=bind(this.centerOn,this),this.animateInfoboxes=bind(this.animateInfoboxes,this),this.positionInfoboxes=bind(this.positionInfoboxes,this),this.animateMarkers=bind(this.animateMarkers,this),this.setMarkers=bind(this.setMarkers,this),this.animateBackground=bind(this.animateBackground,this),this.setBackground=bind(this.setBackground,this),this.resetImage=bind(this.resetImage,this),this["new"]=bind(this["new"],this),this.container=this.options.container,this.markersContainer=this.container.find("."+Planit.markerContainerClass),this.image=this.container.find("img").first(),this.zoomId=Planit.randomString(),this.markersContainer.attr("data-zoom-id",this.zoomId),this.imagePosition={leftPx:0,topPx:0,width:this.image.width(),height:this.image.height(),scale:1,increment:.5},this.setBackground()}return t.prototype["new"]=function(){return this.container.prepend('<div class="planit-controls">\n  <a href="#" class="zoom" data-action="in">+</a>\n  <a href="#" class="zoom" data-action="out">-</a>\n</div>'),this.container.find(".zoom[data-action='in']").click(function(t){return function(i){return i.preventDefault(),t.zoomIn()}}(this)),this.container.find(".zoom[data-action='out']").click(function(t){return function(i){return i.preventDefault(),t.zoomOut()}}(this)),this.container.on("dblclick",this.dblclick),this.container.on("mousedown",this.mousedown),$(document).on("mousemove",this.mousemove),$(document).on("mouseup",this.mouseup)},t.prototype.resetImage=function(){return this.imagePosition={leftPx:0,topPx:0,width:this.image.width(),height:this.image.height(),scale:1,increment:.5},this.setBackground()},t.prototype.setBackground=function(){return this.image.css({left:this.imagePosition.leftPx+"px",top:this.imagePosition.topPx+"px",width:100*this.imagePosition.scale+"%",height:"auto"}),this.setMarkers()},t.prototype.animateBackground=function(){return this.image.animate({left:this.imagePosition.leftPx+"px",top:this.imagePosition.topPx+"px",width:100*this.imagePosition.scale+"%",height:"auto"},250),this.animateMarkers()},t.prototype.setMarkers=function(){var t,i,n,o,e,s;if(e=this.container.find("div.planit-marker"),e.length>0){for(t=0,n=e.length;n>t;t++)o=e[t],i=this.imgWidth()*($(o).attr("data-xPc")/100)+this.imagePosition.leftPx-$(o).outerWidth()/2,s=this.imgHeight()*($(o).attr("data-yPc")/100)+this.imagePosition.topPx-$(o).outerHeight()/2,$(o).css({left:i+"px",top:s+"px"});return this.positionInfoboxes()}},t.prototype.animateMarkers=function(){var t,i,n,o,e,s,r,a;if(s=this.container.find("div.planit-marker"),s.length>0){for(r=[],t=0,n=s.length;n>t;t++)e=s[t],o=new Planit.Marker(this.container,$(e).attr("data-marker")),o.hideInfobox(),i=this.imgWidth()*($(e).attr("data-xPc")/100)+this.imagePosition.leftPx-$(e).outerWidth()/2,a=this.imgHeight()*($(e).attr("data-yPc")/100)+this.imagePosition.topPx-$(e).outerHeight()/2,r.push(function(t){return $(e).animate({left:i+"px",top:a+"px"},250,function(){return function(){return t.positionInfobox(),t.unhideInfobox()}}(this))}(o));return r}},t.prototype.positionInfoboxes=function(){var t,i,n,o,e;for(e=this.container.find(".planit-marker"),t=0,i=e.length;i>t;t++)o=e[t],n=new Planit.Marker(this.container,$(o).attr("data-marker")),n.positionInfobox();return!0},t.prototype.animateInfoboxes=function(){var t,i,n,o,e;for(e=this.container.find(".planit-marker"),t=0,i=e.length;i>t;t++)o=e[t],n=new Planit.Marker(this.container,$(o).attr("data-marker")),n.animateInfobox();return!0},t.prototype.centerOn=function(t){var i,n,o,e;for(o=t[0]>=50?100-t[0]:t[0],e=t[1]>=50?100-t[1]:t[1],n=50*(this.containerWidth()/o),i=50*(this.containerHeight()/e),this.container.find(".planit-infobox").removeClass("active"),this.imagePosition.leftPx=-(this.imgWidth()*(t[0]/100)-this.containerWidth()/2),this.imagePosition.topPx=-(this.imgHeight()*(t[1]/100)-this.containerHeight()/2);this.imgWidth()<n||this.imgHeight()<i;)this.imagePosition.scale=this.imagePosition.scale+this.imagePosition.increment,this.imagePosition.leftPx=-(this.imgWidth()*(t[0]/100)-this.containerWidth()/2),this.imagePosition.topPx=-(this.imgHeight()*(t[1]/100)-this.containerHeight()/2);return this.animateBackground()},t.prototype.zoomTo=function(t){var i;return i=this.imagePosition.increment,t*i+1!==this.imagePosition.scale?(this.imagePosition.scale=t*i+1+i,this.zoomOut()):void 0},t.prototype.imgWidth=function(){return parseFloat(this.imagePosition.width*this.imagePosition.scale)},t.prototype.tmpImgWidth=function(){return(1+this.imagePosition.increment)*this.imagePosition.width()},t.prototype.imgWidthClickIncrement=function(){return parseFloat(this.imagePosition.width*this.imagePosition.increment)},t.prototype.imgWidthScrollIncrement=function(){return parseFloat(this.imagePosition.width*this.imagePosition.scrollIncrement)},t.prototype.containerWidth=function(){return parseFloat(this.markersContainer.width())},t.prototype.imgOffsetLeft=function(){return Math.abs(parseFloat(this.image.css("left")))},t.prototype.imgHeight=function(){return parseFloat(this.imagePosition.height*this.imagePosition.scale)},t.prototype.tmpImgHeight=function(){return(1+this.imagePosition.increment)*this.imagePosition.height()},t.prototype.imgHeightClickIncrement=function(){return parseFloat(this.imagePosition.height*this.imagePosition.increment)},t.prototype.imgHeightScrollIncrement=function(){return parseFloat(this.imagePosition.height*this.imagePosition.scrollIncrement)},t.prototype.containerHeight=function(){return parseFloat(this.markersContainer.height())},t.prototype.imgOffsetTop=function(){return Math.abs(parseFloat(this.image.css("top")))},t.prototype.getEventContainerPosition=function(t){return{left:(t.pageX-this.container.offset().left)/this.containerWidth(),top:(t.pageY-this.container.offset().top)/this.containerHeight()}},t.prototype.dblclick=function(t){var i;return $(t.target).attr("data-zoom-id")===this.zoomId?(i=this.getEventContainerPosition(t),this.zoomIn("click",i.left,i.top)):void 0},t.prototype.mousedown=function(t){var i;return $(t.target).attr("data-zoom-id")===this.zoomId&&1===t.which&&(this.isDragging=!0,i=this.getEventContainerPosition(t),this.dragCoords={pointRef:i,imgRef:{left:0-this.imgOffsetLeft(),top:0-this.imgOffsetTop()},max:{right:i.left*this.containerWidth()+this.imgOffsetLeft(),left:i.left*this.containerWidth()-(this.imgWidth()-(this.containerWidth()+this.imgOffsetLeft())),bottom:i.top*this.containerHeight()+this.imgOffsetTop(),top:i.top*this.containerHeight()-(this.imgHeight()-(this.containerHeight()+this.imgOffsetTop()))}}),!0},t.prototype.mousemove=function(t){var i,n,o,e,s;return this.isDragging&&(i=this.getEventContainerPosition(t),n=i.left*this.containerWidth(),o=i.top*this.containerHeight(),n>=this.dragCoords.max.left&&n<=this.dragCoords.max.right?(e=(i.left-this.dragCoords.pointRef.left)*this.containerWidth(),this.imagePosition.leftPx=this.dragCoords.imgRef.left+e):n<this.dragCoords.max.left?this.imagePosition.leftPx=this.containerWidth()-this.imgWidth():n>this.dragCoords.max.right&&(this.imagePosition.leftPx=0),o>=this.dragCoords.max.top&&o<=this.dragCoords.max.bottom?(s=(i.top-this.dragCoords.pointRef.top)*this.containerHeight(),this.imagePosition.topPx=this.dragCoords.imgRef.top+s):o<this.dragCoords.max.top?this.imagePosition.topPx=this.containerHeight()-this.imgHeight():o>this.dragCoords.max.bottom&&(this.imagePosition.topPx=0),this.setBackground()),!0},t.prototype.mouseup=function(){return this.isDragging=!1,this.positionInfoboxes(),!0},t.prototype.zoomIn=function(){return this.imagePosition.scale=this.imagePosition.scale+this.imagePosition.increment,this.imagePosition.leftPx=-this.imgOffsetLeft()-this.imgWidthClickIncrement()/2,this.imagePosition.topPx=-this.imgOffsetTop()-this.imgHeightClickIncrement()/2,this.animateBackground()},t.prototype.zoomOut=function(){var t,i;return this.imagePosition.scale>1?(this.imagePosition.scale=this.imagePosition.scale-this.imagePosition.increment,t=-this.imgOffsetLeft()+this.imgWidthClickIncrement()/2,i=-this.imgOffsetTop()+this.imgHeightClickIncrement()/2,this.imagePosition.leftPx=t>0?0:t<this.containerWidth()-this.imgWidth()?this.containerWidth()-this.imgWidth():t,this.imagePosition.topPx=i>0?0:i<this.containerHeight()-this.imgHeight()?this.containerHeight()-this.imgHeight():i,this.animateBackground()):void 0},t}(),Planit.Marker=function(){function t(t,i){this.container=t,this.remove=bind(this.remove,this),this.update=bind(this.update,this),this.savePosition=bind(this.savePosition,this),this.set=bind(this.set,this),this.isDraggable=bind(this.isDraggable,this),this.animateInfobox=bind(this.animateInfobox,this),this.positionInfobox=bind(this.positionInfobox,this),this.infoboxCoords=bind(this.infoboxCoords,this),this.unhideInfobox=bind(this.unhideInfobox,this),this.showInfobox=bind(this.showInfobox,this),this.hideInfobox=bind(this.hideInfobox,this),this.infoboxVisible=bind(this.infoboxVisible,this),this.infoboxHTML=bind(this.infoboxHTML,this),this.infobox=bind(this.infobox,this),this.id=bind(this.id,this),this.planitID=bind(this.planitID,this),this.color=bind(this.color,this),this.relativePosition=bind(this.relativePosition,this),this.position=bind(this.position,this),this.markersContainer=this.container.find("."+Planit.markerContainerClass),this.container.find(".image-container > img").length>0&&(this.image=this.container.find(".image-container > img").first()),this.marker=this.markersContainer.find("."+Planit.markerClass+"[data-marker='"+i+"']").first()}return t.prototype.position=function(){var t,i,n,o,e,s,r,a;return e=this.marker.position().left+this.marker.outerWidth()/2,a=this.marker.position().top+this.marker.outerHeight()/2,this.image?(i=this.image.width(),t=this.image.height(),n=parseInt(this.image.css("left")),s=parseInt(this.image.css("top")),o=(e+Math.abs(n))/i*100,r=(a+Math.abs(s))/t*100):(o=e/this.container.width()*100,r=a/this.container.height()*100),[o,r]},t.prototype.relativePosition=function(){var t,i,n,o;return i=this.marker.position().left+this.marker.outerWidth()/2,o=this.marker.position().top+this.marker.outerHeight()/2,t=i/this.container.width()*100,n=o/this.container.height()*100,[t,n]},t.prototype.color=function(){return this.marker.css("backgroundColor")},t.prototype.planitID=function(){return this.marker.attr("data-marker")},t.prototype.id=function(){return this.marker.attr("data-id")},t.prototype.infobox=function(){var t;return t=this.container.find("#"+this.marker.attr("data-infobox")),t.length>0?t:null},t.prototype.infoboxHTML=function(){return this.infobox()&&this.infobox().length>0?this.infobox().html():null},t.prototype.infoboxVisible=function(){return this.infobox()&&this.infobox().hasClass("active")},t.prototype.hideInfobox=function(){return this.infoboxVisible()?this.infobox().addClass("hidden"):void 0},t.prototype.showInfobox=function(){return this.infobox()&&!this.infoboxVisible()&&this.infobox().addClass("active"),this.unhideInfobox()},t.prototype.unhideInfobox=function(){return this.infoboxVisible()?this.infobox().removeClass("hidden"):void 0},t.prototype.infoboxCoords=function(){var t,i,n,o,e,s,r,a,h,m,g,c,p,d,f,l,u,k;switch(m=$("#"+this.marker.attr("data-infobox")),f=parseFloat(this.relativePosition()[0]/100)*this.container.width(),l=parseFloat(this.relativePosition()[1]/100)*this.container.height(),r=m.outerWidth(),e=r/2,s=m.outerHeight(),o=s/2,n=this.container.width(),i=this.container.height(),d=this.marker.outerWidth(),c=d/2,p=this.marker.outerHeight(),g=p/2,t=5,u=parseInt(m.attr("data-offset-x")),u||(u=0),k=parseInt(m.attr("data-offset-y")),k||(k=0),m.attr("data-position")){case"top":a=f-e,h=l-s-g-t;break;case"right":a=f+c+t,h=l-o;break;case"bottom":a=f-e,h=l+g+t;break;case"left":a=f-r-c-t,h=l-o;break;case"top-left":a=f-r-c+t,h=l-s-g+t;break;case"top-right":a=f+c-t,h=l-s-g+t;break;case"bottom-left":a=f-r-c+t,h=l+g-t;break;case"bottom-right":a=f+c-t,h=l+g-t}return{left:a+u,top:h+k}},t.prototype.positionInfobox=function(){var t;return t=this.infoboxCoords(),$("#"+this.marker.attr("data-infobox")).css({left:t.left+"px",top:t.top+"px"}),this.position()},t.prototype.animateInfobox=function(){var t;return t=this.infoboxCoords(),$("#"+this.marker.attr("data-infobox")).animate({left:t.left+"px",top:t.top+"px"},250,function(t){return function(){return t.position()}}(this))},t.prototype.isDraggable=function(){return this.marker.hasClass("draggable")},t.prototype.set=function(){var t,i;return t=this.image.width()*(this.marker.attr("data-xPc")/100)+parseFloat(this.image.css("left"))-this.marker.outerWidth()/2,i=this.image.height()*(this.marker.attr("data-yPc")/100)+parseFloat(this.image.css("top"))-this.marker.outerHeight()/2,this.marker.css({left:t+"px",top:i+"px"}),this.positionInfobox(),[t,i]},t.prototype.savePosition=function(){var t;return t=this.position(),this.marker.attr({"data-xPc":t[0],"data-yPc":t[1]})},t.prototype.update=function(t){var i,n;return t.color&&this.marker.css({backgroundColor:t.color}),t.infobox&&(this.marker.find(".planit-infobox").html(t.infobox),this.positionInfobox()),t.draggable&&(this.marker.removeClass("draggable"),t.draggable===!0&&this.marker.addClass("draggable")),t.coords?(i=parseFloat(t.coords[0])/100*this.container.width()-15,n=parseFloat(t.coords[1])/100*this.container.height()-15,this.marker.css({left:i+"px",top:n+"px"})):void 0},t.prototype.remove=function(){return this.infobox()&&this.infobox().remove(),this.marker.remove()},t}(),Planit.Marker.Events=function(){function t(t){var i,n,o,e,s,r;this.options=t,this.container=this.options.container,this.markersContainer=this.container.find("."+Planit.markerContainerClass),this.marker=this.markersContainer.find("."+Planit.markerClass+"[data-marker='"+this.options.planitID+"']").first(),this.markerObj=new Planit.Marker(this.container,this.options.planitID),this.options.draggable&&(this.marker.addClass("draggable"),this.marker.on("mousedown",function(){return function(t){var i;return 1===t.which?(i=$(t.target).closest(".planit-marker"),i.addClass("is-dragging"),i.attr({"data-drag-start-x":t.pageX,"data-drag-start-y":t.pageY})):void 0}}(this))),this.options.infobox&&(e=Planit.randomString(16),s=this.options.infobox,r=s.position?s.position:"top",i=s.arrow?!0:!1,n=i===!0?"arrow":"",o="planit-infobox "+r+" "+n,this.container.find("."+Planit.infoboxContainerClass).append('<div class="'+o+'" id="info-'+e+'"\n  data-position="'+r+'">\n    '+s.html+"\n</div>"),s.offsetX&&this.container.find(".planit-infobox").last().attr({"data-offset-x":s.offsetX}),s.offsetY&&this.container.find(".planit-infobox").last().attr({"data-offset-y":s.offsetY}),this.marker.attr("data-infobox","info-"+e),this.markerObj.positionInfobox())}return t.prototype.markers=function(){return this.markersContainer.find(".planit-marker")},t.prototype.draggingMarker=function(){return this.markersContainer.find(".planit-marker.is-dragging")},t}(),Planit.Marker.Creator=function(){function t(t){var i,n,o,e;this.options=t,this.container=this.options.container,this.markersContainer=this.container.find("."+Planit.markerContainerClass).first(),this.options.planitID||(this.options.planitID=Planit.randomString(20)),i=this.options.color?this.options.color:"#FC5B3F",n=parseFloat(this.options.coords[0])/100*this.container.width()-15,e=parseFloat(this.options.coords[1])/100*this.container.height()-15,this.markersContainer.append($("<div></div>").addClass("planit-marker").attr({"data-marker":this.options.planitID,"data-xPc":this.options.coords[0],"data-yPc":this.options.coords[1]}).css({left:n+"px",top:e+"px",backgroundColor:i})),o=this.markersContainer.find(".planit-marker").last(),this.options.id&&o.attr({"data-id":this.options.id}),this.options["class"]&&o.addClass(this.options["class"]),this.options.html&&o.html(this.options.html),this.options.size&&o.css({width:this.options.size+"px",height:this.options.size+"px"}),new Planit.Marker.Events(this.options),new Planit.Marker(this.container,this.options.planitID)}return t}();